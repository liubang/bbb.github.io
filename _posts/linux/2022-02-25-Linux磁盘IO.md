---
layout: article
title: Linux磁盘IO
tags: [linux, IO]
published: false
---

## 1. 前言

做存储开发，一定会经常涉及到 IO 相关的操作。而现在的高级编程语言，往往会帮助我们屏蔽 IO 操作的底层细节，虽然这样能降低开发门槛，提升效率，但是却也导致我们对 IO 底层操作实现的理解不够系统和深入。
所以呢，我一直想抽时间来系统整理一下 Linux IO 涉及的系统调用，以及相互之间的区别和联系，以加深对 IO 操作的理解。

## 2. IO 操作

### 2.1 fwrite

fwrite 是 c 语言标准库中的文件写入函数，其作用是向指定的文件中写入若干数据。调用 fwrite 实际上是将数据写入到了 c 标准库的 IO Buffer 中。

### 2.2 mmap

mmap 就是将一个文件或其他对象映射到内存。

### 2.3 fflush

fflush 就是将 c 标准库中的 IO Buffer 中的数据写入到参数 stream 指定的文件中。

### 2.4 fsync

fsync 系统调用就是将内核缓冲区中的数据同步到存储介质(如硬盘)。也可以在 open 文件的时候通过开启`O_SYNC`来开启同步 I/O.

## 3. 各 IO 操作的区别与联系

![图片引用自 https://oscimg.oschina.net/oscnet/51a17cc9aa34eba47971af609fdecabf398.jpg](/static/images/2022-02-28/linux_io_sub_system_arch.jpeg)

<center>图片引用自 <a href="https://oscimg.oschina.net/oscnet/51a17cc9aa34eba47971af609fdecabf398.jpg"> https://oscimg.oschina.net/oscnet/51a17cc9aa34eba47971af609fdecabf398.jpg </a></center>  


上图非常清晰的展示了 Linux IO 操作相互之间的区别和联系。

## 4. 参考资料

[Linux 中如何保证数据安全落盘](https://my.oschina.net/fileoptions/blog/3061997)
