<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn data-palette=blue-gray><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>基于c语言的编程语言开发 - liubang's blog</title><link rel=apple-touch-icon href=/images/icons/icon-180x180.png sizes=180x180><link rel=icon href=/images/icons/icon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/images/icons/icon-16x16.png sizes=16x16 type=image/png><link rel=icon href=/images/icons/favicon.ico><link rel=manifest href=/zh-cn/manifest.json><meta name=keywords content><meta name=description content="Preface 当今世道，各种高级语言百花齐放。然而会有人发出这样的疑问&ndash;计算机真的能够识别这么多语言吗？稍微有点常识的人都知道，这显然是不可"><meta name=robots content="index, follow"><meta itemprop=name content="基于c语言的编程语言开发"><meta itemprop=description content="Preface 当今世道，各种高级语言百花齐放。然而会有人发出这样的疑问&ndash;计算机真的能够识别这么多语言吗？稍微有点常识的人都知道，这显然是不可"><meta itemprop=datePublished content="2017-03-15T00:00:00+00:00"><meta itemprop=dateModified content="2017-03-15T00:00:00+00:00"><meta itemprop=wordCount content="2915"><meta itemprop=keywords content="c,compiler,"><meta property="og:title" content="基于c语言的编程语言开发"><meta property="og:description" content="Preface 当今世道，各种高级语言百花齐放。然而会有人发出这样的疑问&ndash;计算机真的能够识别这么多语言吗？稍微有点常识的人都知道，这显然是不可"><meta property="og:type" content="article"><meta property="og:url" content="/zh-cn/posts/compiler/2017-03-15-%E5%9F%BA%E4%BA%8Ec%E8%AF%AD%E8%A8%80%E7%9A%84%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E5%BC%80%E5%8F%91/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-03-15T00:00:00+00:00"><meta property="article:modified_time" content="2017-03-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="基于c语言的编程语言开发"><meta name=twitter:description content="Preface 当今世道，各种高级语言百花齐放。然而会有人发出这样的疑问&ndash;计算机真的能够识别这么多语言吗？稍微有点常识的人都知道，这显然是不可"><meta property="og:image" content="/images/apple-touch-icon.png"><meta name=twitter:image content="/images/apple-touch-icon.png"><link rel=stylesheet href="/assets/main/bundle.min.09d46120a2d307cfc51077c7753203663e195c18e9b9018398f9926f829cd18d.css" integrity="sha256-CdRhIKLTB8/FEHfHdTIDZj4ZXBjpuQGDmPmSb4Kc0Y0=" crossorigin=anonymous><link rel=stylesheet href=/assets/katex/bundle.min.1e4d98f6a1073d58e1fc772be53b5b12b73e09bf4fa0d5ef6e2df558c8188ef8.css integrity="sha256-Hk2Y9qEHPVjh/Hcr5TtbErc+Cb9PoNXvbi31WMgYjvg=" crossorigin=anonymous><link rel=stylesheet href=/assets/viewer/bundle.min.f05183267bb952fbc8c63a7178364de2951614ab71d544ec1068ad36c7447ccc.css integrity="sha256-8FGDJnu5UvvIxjpxeDZN4pUWFKtx1UTsEGitNsdEfMw=" crossorigin=anonymous></head><body><script>const items=["mode","palette"];items.forEach(function(e){const t=localStorage.getItem("hbs-"+e);t&&document.body.parentElement.setAttribute("data-"+e,t)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top"><div class=container><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-bars"></i>
</button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto me-lg-3" href=/zh-cn/><img class=logo alt=Logo src=/images/apple-touch-icon.png loading=lazy width=180 height=180>
HIGHKYCK</a><div class="offcanvas offcanvas-bottom surface" tabindex=-1 id=offcanvasSocialShare aria-labelledby=offcanvasSocialShare><div class=offcanvas-header><h3 class=offcanvas-title>Share</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button" target=_blank href="https://twitter.com/intent/tweet?title=%e5%9f%ba%e4%ba%8ec%e8%af%ad%e8%a8%80%e7%9a%84%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80%e5%bc%80%e5%8f%91&url=%2fzh-cn%2fposts%2fcompiler%2f2017-03-15-%25E5%259F%25BA%25E4%25BA%258Ec%25E8%25AF%25AD%25E8%25A8%2580%25E7%259A%2584%25E7%25BC%2596%25E7%25A8%258B%25E8%25AF%25AD%25E8%25A8%2580%25E5%25BC%2580%25E5%258F%2591%2f"><i class="fab fa-fw fa-twitter"></i> Twitter</a>
<a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=%2fzh-cn%2fposts%2fcompiler%2f2017-03-15-%25E5%259F%25BA%25E4%25BA%258Ec%25E8%25AF%25AD%25E8%25A8%2580%25E7%259A%2584%25E7%25BC%2596%25E7%25A8%258B%25E8%25AF%25AD%25E8%25A8%2580%25E5%25BC%2580%25E5%258F%2591%2f"><i class="fab fa-fw fa-facebook-f"></i> Facebook</a></div></div><button class=navbar-settings type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSettings aria-controls=offcanvasSettings aria-label="Toggle settings">
<i class="fas fa-ellipsis-v"></i></button><div class="offcanvas offcanvas-end surface h-100" tabindex=-1 id=offcanvasSettings aria-labelledby=offcanvasSettings><div class=offcanvas-header><h3 class=offcanvas-title>设置</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class="offcanvas-body d-flex flex-column"><div class=setting><form class=row><div class=col-auto><label for=fontSize class=form-label><i class="fas fa-fw fa-language"></i> 语言</label></div><div class="col-auto ms-auto"><div class=dropdown><a class="btn btn-sm btn-outline-primary dropdown-toggle" href=# id=languageDropdown role=button data-bs-toggle=dropdown aria-expanded=false>简体中文</a><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=languageDropdown><li><a class=dropdown-item href=/en/>English</a></li></ul></div></div></form></div><div class=setting><form class=row><div class=col-auto><label><i class="fas fa-fw fa-adjust"></i> 模式</label></div><div class="col-auto ms-auto"><div class="form-check form-switch"><input class=form-check-input type=checkbox id=modeSwitcher></div></div></form></div><div class="setting palettes"><form class=row><div class=col-auto><label><i class="fas fa-fw fa-palette"></i> 配色</label></div><div class="col-auto ms-auto"><a id=btnPalette class="btn btn-sm btn-outline-primary" role=button aria-label=palettePicker><i class="fas fa-eye-dropper"></i></a></div></form><div class="mt-2 d-flex justify-content-between visually-hidden" id=palettePicker><button type=button id=palette-blue aria-label=蓝色 class="btn btn-sm w-100 palette" data-palette=blue>
</button><button type=button id=palette-blue-gray aria-label=蓝灰色 class="btn btn-sm w-100 palette" data-palette=blue-gray>
</button><button type=button id=palette-brown aria-label=棕色 class="btn btn-sm w-100 palette" data-palette=brown>
</button><button type=button id=palette-cyan aria-label=青色 class="btn btn-sm w-100 palette" data-palette=cyan>
</button><button type=button id=palette-green aria-label=绿色 class="btn btn-sm w-100 palette" data-palette=green>
</button><button type=button id=palette-indigo aria-label=靛青色 class="btn btn-sm w-100 palette" data-palette=indigo>
</button><button type=button id=palette-orange aria-label=橙色 class="btn btn-sm w-100 palette" data-palette=orange>
</button><button type=button id=palette-pink aria-label=粉色 class="btn btn-sm w-100 palette" data-palette=pink>
</button><button type=button id=palette-purple aria-label=紫色 class="btn btn-sm w-100 palette" data-palette=purple>
</button><button type=button id=palette-red aria-label=红色 class="btn btn-sm w-100 palette" data-palette=red>
</button><button type=button id=palette-teal aria-label=蓝绿色 class="btn btn-sm w-100 palette" data-palette=teal>
</button><button type=button id=palette-yellow aria-label=黄色 class="btn btn-sm w-100 palette" data-palette=yellow></button></div></div><div class="setting actions d-flex justify-content-around mt-auto overflow-auto"><a role=button class="action action-go-back" href="javascript: window.history.back();"><span class=action-icon><i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i></span> 返回</a>
<a role=button class="action action-reload-page"><span class=action-icon><i class="fas fa-2x fa-redo-alt"></i></span> 刷新</a>
<a role=button class="action action-copy-url"><span class=action-icon><i class="fas fa-2x fa-link"></i></span> 复制链接
</a><a class="action action-social-share" role=button data-bs-toggle=offcanvas data-bs-target=#offcanvasSocialShare aria-controls=offcanvasSocialShare aria-label="Toggle social share"><span class=action-icon><i class="fas fa-2x fa-share-alt"></i></span> 分享</a></div></div></div><div class="collapse navbar-collapse" tabindex=-1 id=navbarSupportedContent aria-labelledby=navbarSupportedContent><form class="search-bar my-1" action=/zh-cn/search><div class="input-group input-group-sm"><span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
<input class="form-control rounded-pill" name=q type=search aria-label=Search></div></form><ul class="navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/zh-cn/series/><i class="fas fa-fw fa-columns"></i>专栏</a></li><li class=nav-item><a class=nav-link href=/zh-cn/archives/><i class="fas fa-fw fa-file-archive"></i>归档</a></li><li class=nav-item><a class=nav-link href=/zh-cn/categories/><i class="fas fa-fw fa-folder"></i>分类</a></li><li class=nav-item><a class=nav-link href=/zh-cn/tags/><i class="fas fa-fw fa-tags"></i>标签</a></li></ul></div></div></nav></header><main class=container><div class="row content"><div class=col-lg-8><div class=container><nav class="row card component" aria-label=breadcrumb><div class=card-body><ol class=breadcrumb><li class=breadcrumb-item><a href=/zh-cn/>主页</a></li><li class=breadcrumb-item><a href=/zh-cn/posts/>文章</a></li><li class="breadcrumb-item active">基于c语言的编程语言开发</li></ol></div></nav><div class=post-panel-wrapper><div class="d-flex flex-column component rounded post-panel"><a class="action action-panel-toggler" role=button title="Panel toggler"><i class="fas fa-fw fa-chevron-circle-down"></i></a>
<a id=sidebarToggler class="action d-none d-lg-block" role=button title="Sidebar toggler"><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a>
<a class=action href=#post-copyright role=button aria-label=Copyright title=Copyright><i class="fas fa-fw fa-copyright"></i></a>
<a class=action href=#post-comments role=button aria-label=Comments title=Comments><i class="fas fa-fw fa-comments"></i></a></div></div><article class="row card component mb-4 post"><div class=card-header><h1 class="card-title post-title">基于c语言的编程语言开发</h1></div><div class=card-body><div class=post-meta><span class=post-date title="创建于 2017-03-15 00:00:00 +0000 UTC。">2017-03-15
</span><span class=post-reading-time>6 分钟阅读
</span><span class=post-taxonomies><a href=/zh-cn/tags/c/ class="badge post-taxonomy">c</a><a href=/zh-cn/tags/compiler/ class="badge post-taxonomy">compiler</a></span></div><div class="post-share mb-3"><div class=addthis_inline_share_toolbox></div></div><div class="post-content mb-3"><h1 id=preface>Preface<a class="anchor ms-1" href=#preface><i class="fas fa-link"></i></a></h1><p>当今世道，各种高级语言百花齐放。然而会有人发出这样的疑问&ndash;计算机真的能够识别这么多语言吗？稍微有点常识的人都知道，这显然是不可能滴！在计算机的世界里，他们能够直接识别的只有机器语言。然而，由于机器语言对人类不够友好，所以人们才发明了汇编，c，Java&mldr;许许多多的人类易读的编程语言，所以我个人对编程语言的理解一直是其实他们就是机器语言的语法糖，而编程语言的创造过程，就是定义一种合理的，没有二义性的语法规则，然后就是通过直接或间接的方式实现该语法到机器语言的转换过程。既然是这样的话，那么我们就很容易想到，计算机语言是一个自我完善的过程：首先我们定了一种非常简单的 x1(这里只是用来举例说明，有没有 x 语言有待考证)语言，然后用机器语言实现了这个非常简单的 x1 语言的编译器，创造了 x1 语言，实现了非常简单的新特性，然后我们再用 x1 语言(相对于机器语言较高级)实现了另一些新的特性的 x2 语言的编译器，创造了 x2 语言，&mldr;，如此下去，人们创造了汇编语言，从而创造了 c 语言，接着创造了世界上最好的语言 PHP(不知道是不是真的，反正大家都习惯这么说)。
在各种高级语言越来越强大的今天，我们可能很难再会去接触最原始的东西，高度封装确实提高了生产力，降低了学习成本，但是也使得现代程序员将太多精力花在了各种说明书上，而不清楚其本质。
毕业一年多，工作了一年多，对于计算机编程有了自己的看法，不再像在大学的时候认识的那样肤浅，反而觉得大学中学习的知识才是真正的干货，不禁感叹曾经浪费掉了大好光阴。好在陶渊明有词云：“悟已往之不谏，知来者之可追”。
闲暇之余，扒开 PHP(这里之所以是 PHP 并不因为他是世界上最好的语言，只是因为我目前从事的是 PHP 开发的工作而已)源码，了解了其内部构造和实现原理，百看不一练。今天就初步学习 yacc/lex 了，记录在我的博客中，以便以后翻阅巩固。</p><h1 id=过程简述>过程简述<a class="anchor ms-1" href=#过程简述><i class="fas fa-link"></i></a></h1><p>一般来说编程语言的解释执行过程如下：</p><p><strong>ONE</strong>. 词法分析
将源代码拆分成若干 Token 的过程</p><p><strong>TWO</strong>.语法分析
将 Token 构建成 Syntax Tree 的过程</p><p><strong>THREE</strong>.生成执行码
生成可执行文件</p><h1 id=yaccyet-another-compiler-compiler>yacc（Yet Another Compiler Compiler）<a class="anchor ms-1" href=#yaccyet-another-compiler-compiler><i class="fas fa-link"></i></a></h1><p>下面是 wikipedia 中对 yacc 的描述</p><blockquote><p>Yacc is a computer program for the Unix operating system. It is a Look Ahead Left-to-Right (LALR) parser generator, generating a parser, the part of a compiler that tries to make syntactic sense of the source code, specifically a LALR parser, based on an analytic grammar written in a notation similar to Backus–Naur Form (BNF). Yacc itself used to be available as the default parser generator on most Unix systems, though it has since been supplanted as the default by more recent, largely compatible, programs.</p></blockquote><p>其安装非常简单</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>sudo apt-get install bison
</span></span></code></pre></div><h1 id=lexflex>lex/flex<a class="anchor ms-1" href=#lexflex><i class="fas fa-link"></i></a></h1><p>lex 是一个生成词法分析器的工具。Lex 读进一个代表词法分析器规则的输入字符串流，然后输出以 C 语言实做的词法分析器源代码。传统上，lex 属于商业软件，但是有些根据原本 AT&T 代码这些版本的 Lex 可以以公开源代码的形式获得，并被视为某些系统的一部分，例如说 OpenSolaris 和贝尔实验室九号项目。另一个有名的 Lex 公开源代码版本是 flex，代表"快速的词法分析器"（fast lexical analyzer）</p><p>在 linux 下安装</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>sudo apt-get install flex
</span></span></code></pre></div><h1 id=practice>practice<a class="anchor ms-1" href=#practice><i class="fas fa-link"></i></a></h1><ul><li>实现一个简单的计算程序</li></ul><p>首先定义 lex 规则，其扩展名为<code>.l</code>，在 lex 中可以很容易读懂其定义的规则，因为他用到的是正则表达式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln> 1</span><span class=cl><span class=o>%</span><span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=cm> | linger test
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=cm> | @author    : liubang
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=cm> | @date      : 16/10/27 下午8:28
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=cm> | @copyright : (c) iliubang.cn
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=cm> | @license   : MIT (http://opensource.org/licenses/MIT)
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;y.tab.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=cp></span>
</span></span><span class=line><span class=ln>16</span><span class=cl><span class=kt>int</span> <span class=n>yywrap</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>	<span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>20</span><span class=cl><span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=o>%%</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>
</span></span><span class=line><span class=ln>24</span><span class=cl><span class=s>&#34;+&#34;</span>		<span class=k>return</span> <span class=n>ADD</span><span class=p>;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=s>&#34;-&#34;</span>		<span class=k>return</span> <span class=n>SUB</span><span class=p>;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl><span class=s>&#34;*&#34;</span>		<span class=k>return</span> <span class=n>MUL</span><span class=p>;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl><span class=s>&#34;/&#34;</span>		<span class=k>return</span> <span class=n>DIV</span><span class=p>;</span>
</span></span><span class=line><span class=ln>28</span><span class=cl><span class=s>&#34;</span><span class=se>\n</span><span class=s>&#34;</span>		<span class=k>return</span> <span class=n>CR</span><span class=p>;</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>
</span></span><span class=line><span class=ln>30</span><span class=cl><span class=p>([</span><span class=mi>1</span><span class=o>-</span><span class=mi>9</span><span class=p>][</span><span class=mi>0</span><span class=o>-</span><span class=mi>9</span><span class=p>]</span><span class=o>*</span><span class=p>)</span><span class=o>|</span><span class=mi>0</span><span class=o>|</span><span class=p>([</span><span class=mi>0</span><span class=o>-</span><span class=mi>9</span><span class=p>]</span><span class=o>+</span><span class=err>\</span><span class=p>.[</span><span class=mi>0</span><span class=o>-</span><span class=mi>9</span><span class=p>]</span><span class=o>+</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>	<span class=kt>double</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>	<span class=n>sscanf</span><span class=p>(</span><span class=n>yytext</span><span class=p>,</span> <span class=s>&#34;%lf&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>d</span><span class=p>);</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>	<span class=n>yylval</span><span class=p>.</span><span class=n>double_value</span> <span class=o>=</span> <span class=n>d</span><span class=p>;</span>
</span></span><span class=line><span class=ln>34</span><span class=cl>	<span class=k>return</span> <span class=n>DOUBLE_LITERAL</span><span class=p>;</span>
</span></span><span class=line><span class=ln>35</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>
</span></span><span class=line><span class=ln>37</span><span class=cl><span class=p>[</span> <span class=err>\</span><span class=n>t</span><span class=p>]</span> <span class=p>;</span>
</span></span><span class=line><span class=ln>38</span><span class=cl><span class=p>.</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>39</span><span class=cl>	<span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;lexical error.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>40</span><span class=cl>	<span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=ln>41</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>42</span><span class=cl><span class=o>%%</span>
</span></span></code></pre></div><p>可以看到以上的代码主要包含两部分，<code>%{</code> <code>%}</code>包含的部分和<code>\%\%</code> <code>\%\%</code>包含的部分。前一部分叫<strong>定义区块</strong>, 后者是<strong>规则区块</strong>，定义区块内的代码将会被原样输出，在定义区块中<code>#include "y.tab.h"</code>将会在 yacc 编译其规则文件后自动生成，<code>ADD</code> <code>SUB</code> <code>MUL</code> <code>DIV</code> <code>CR</code> <code>DOUBLE_LITERAL</code>等都是在 y.tab.h 中定义的 macro。
在定义区块中，有一个名为<code>yywrap</code>的 function，其作用是自动 link lex 的库文件。
至于规则区块，学过正则表达式的人一看就会明白，其作用就是使用正则表达式来描述 Token。规则区块的定义为：正则表达式，后边跟上 C 代码，这些代码用<code>{}</code>括起来，读入的字符流满足了正则，则执行其后的代码，匹配到的原字符被保存在<code>yytext</code>这个全局变量中。</p><p>接着来编写 yacc 的规则，其扩展名为<code>.y</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln> 1</span><span class=cl><span class=o>%</span><span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=cm> | linger test
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=cm> | @author    : liubang
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=cm> | @date      : 16/10/27 下午8:43
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=cm> | @copyright : (c) iliubang.cn
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=cm> | @license   : MIT (http://opensource.org/licenses/MIT)
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=cm> |------------------------------------------------------------------
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=cp>#define YYDEBUG 1
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=cp></span>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=o>%</span><span class=p>}</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=o>%</span><span class=k>union</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>	<span class=kt>int</span>	<span class=n>int_value</span><span class=p>;</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>	<span class=kt>double</span>	<span class=n>double_value</span><span class=p>;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>
</span></span><span class=line><span class=ln>24</span><span class=cl><span class=o>%</span><span class=n>token</span> <span class=o>&lt;</span><span class=n>double_value</span><span class=o>&gt;</span>		<span class=n>DOUBLE_LITERAL</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=o>%</span><span class=n>token</span> <span class=n>ADD</span> <span class=n>SUB</span> <span class=n>MUL</span> <span class=n>DIV</span> <span class=n>CR</span>
</span></span><span class=line><span class=ln>26</span><span class=cl><span class=o>%</span><span class=n>type</span> <span class=o>&lt;</span><span class=n>double_value</span><span class=o>&gt;</span> <span class=n>expression</span> <span class=n>term</span> <span class=n>primary_expression</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>
</span></span><span class=line><span class=ln>28</span><span class=cl><span class=o>%%</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>
</span></span><span class=line><span class=ln>30</span><span class=cl><span class=nl>line_list</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>	<span class=p>:</span> <span class=n>line</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>	<span class=o>|</span> <span class=n>line_list</span> <span class=n>line</span>
</span></span><span class=line><span class=ln>33</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>34</span><span class=cl><span class=nl>line</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>	<span class=p>:</span> <span class=n>expression</span> <span class=n>CR</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>		<span class=n>printf</span><span class=p>(</span><span class=s>&#34;&gt;&gt;%lf</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=err>$</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>39</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>40</span><span class=cl><span class=nl>expression</span>
</span></span><span class=line><span class=ln>41</span><span class=cl>	<span class=p>:</span> <span class=n>term</span>
</span></span><span class=line><span class=ln>42</span><span class=cl>	<span class=o>|</span> <span class=n>expression</span> <span class=n>ADD</span> <span class=n>term</span>
</span></span><span class=line><span class=ln>43</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>44</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>+</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>45</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>46</span><span class=cl>	<span class=o>|</span> <span class=n>expression</span> <span class=n>SUB</span> <span class=n>term</span>
</span></span><span class=line><span class=ln>47</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>48</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>-</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>50</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>51</span><span class=cl><span class=nl>term</span>
</span></span><span class=line><span class=ln>52</span><span class=cl>	<span class=p>:</span> <span class=n>primary_expression</span>
</span></span><span class=line><span class=ln>53</span><span class=cl>	<span class=o>|</span> <span class=n>term</span> <span class=n>MUL</span> <span class=n>primary_expression</span>
</span></span><span class=line><span class=ln>54</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>55</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>*</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>56</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>57</span><span class=cl>	<span class=o>|</span> <span class=n>term</span> <span class=n>DIV</span> <span class=n>primary_expression</span>
</span></span><span class=line><span class=ln>58</span><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=ln>59</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>/</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>60</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>61</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>62</span><span class=cl><span class=nl>primary_expression</span>
</span></span><span class=line><span class=ln>63</span><span class=cl>	<span class=p>:</span> <span class=n>DOUBLE_LITERAL</span>
</span></span><span class=line><span class=ln>64</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>65</span><span class=cl>
</span></span><span class=line><span class=ln>66</span><span class=cl><span class=o>%%</span>
</span></span><span class=line><span class=ln>67</span><span class=cl>
</span></span><span class=line><span class=ln>68</span><span class=cl><span class=kt>int</span> <span class=n>yyerror</span><span class=p>(</span><span class=kt>char</span> <span class=k>const</span> <span class=o>*</span><span class=n>str</span><span class=p>)</span>
</span></span><span class=line><span class=ln>69</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>70</span><span class=cl>	<span class=k>extern</span> <span class=kt>char</span> <span class=o>*</span><span class=n>yytext</span><span class=p>;</span>
</span></span><span class=line><span class=ln>71</span><span class=cl>	<span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;syntax error near %s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>yytext</span><span class=p>);</span>
</span></span><span class=line><span class=ln>72</span><span class=cl>	<span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=ln>73</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>74</span><span class=cl>
</span></span><span class=line><span class=ln>75</span><span class=cl><span class=kt>int</span> <span class=n>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span>
</span></span><span class=line><span class=ln>76</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>77</span><span class=cl>	<span class=k>extern</span> <span class=kt>int</span> <span class=n>yyparse</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>
</span></span><span class=line><span class=ln>78</span><span class=cl>	<span class=k>extern</span> <span class=n>FILE</span> <span class=o>*</span><span class=n>yyin</span><span class=p>;</span>
</span></span><span class=line><span class=ln>79</span><span class=cl>
</span></span><span class=line><span class=ln>80</span><span class=cl>	<span class=n>yyin</span> <span class=o>=</span> <span class=n>stdin</span><span class=p>;</span>
</span></span><span class=line><span class=ln>81</span><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>yyparse</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>82</span><span class=cl>		<span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;Core Dump!</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>83</span><span class=cl>		<span class=n>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=ln>84</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>85</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>yacc 规则定义跟 lex 相似，都用到了<code>\%{\%}</code> <code>\%\%</code>来包含代码块。
同样的是<code>\%{\%}</code>包裹的代码将被原样输出。
在<code>\%union</code>定义中，声明了记号和非终结符的类型，其最终会被编译成一个 c 语言的 union。这里定义了一个 int 类型的 int_value 和 double 类型的 double_value。
<code>\%token</code>开头的行是 Token 的声明，所有用到的 Token 类型都在这里定义。对于<code>ADD</code> <code>SUB</code> <code>MUL</code> <code>DIV</code> <code>CR</code>等记号只需要包含其类型即可，而对于值为<code>DOUBLE_LITERAL</code>的 Token，其类型被指定为<code>&lt;double_value></code>，这里的 double_value 正是来自于前面声明的 union 中的成员之一。
<code>%%</code>包裹的部分叫做规则区块，由语法规则和 C 语言编写的相应的行为两部分构成。在 yacc 中使用了类似于 BNF 范式来编写语法规则。由于使用了自然语言作为标记，理解上还是很容易的。下面举个简单的例子：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln> 1</span><span class=cl><span class=n>line_list</span>                 <span class=cm>/* 多行规则 */</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>	<span class=o>:</span> <span class=n>line</span>                  <span class=cm>/* 单行 */</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>	<span class=o>|</span> <span class=n>line_list</span> <span class=n>line</span>        <span class=cm>/* 或者多行后跟单行 */</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=n>line</span>                       <span class=cm>/* 单行 */</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>	<span class=o>:</span> <span class=n>expression</span> <span class=n>CR</span>          <span class=cm>/* 表达式后跟换��符 */</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=n>expression</span>                 <span class=cm>/* 表达式 */</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>	<span class=o>:</span> <span class=n>term</span>                   <span class=cm>/* 和项 */</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>	<span class=o>|</span> <span class=n>expression</span> <span class=n>ADD</span> <span class=n>term</span>    <span class=cm>/* 或者表达式加上和项 */</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>	<span class=p>{</span>                        <span class=cm>/* 匹配后执行的action */</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>+</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>	<span class=o>|</span> <span class=n>expression</span> <span class=n>SUB</span> <span class=n>term</span>    <span class=cm>/* 或者表达式减去和项 */</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>	<span class=p>{</span>                        <span class=cm>/* 匹配后执行的action */</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>-</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=n>term</span>                        <span class=cm>/* 和项 */</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>	<span class=o>:</span> <span class=n>primary_expression</span>      <span class=cm>/* 一元表达式 */</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>	<span class=o>|</span> <span class=n>term</span> <span class=n>MUL</span> <span class=n>primary_expression</span> <span class=cm>/* 或者和项乘以一元表达式 */</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>	<span class=p>{</span>                          <span class=cm>/* 匹配后执行的action */</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>*</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>	<span class=o>|</span> <span class=n>term</span> <span class=n>DIV</span> <span class=n>primary_expression</span> <span class=cm>/* 或者和项除以一元表达式 */</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>	<span class=p>{</span>                             <span class=cm>/* 匹配后执行的action */</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>		<span class=err>$$</span> <span class=o>=</span> <span class=err>$</span><span class=mi>1</span> <span class=o>/</span> <span class=err>$</span><span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=ln>30</span><span class=cl><span class=n>primary_expression</span>          <span class=cm>/* 一元表达式 */</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>	<span class=o>:</span> <span class=n>DOUBLE_LITERAL</span>          <span class=cm>/* 实数字面量 */</span>
</span></span><span class=line><span class=ln>32</span><span class=cl><span class=p>;</span>
</span></span></code></pre></div><p>写好了规则，那么就来编译运行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>yacc -dv foo.y
</span></span><span class=line><span class=ln>2</span><span class=cl>flex foo.l
</span></span><span class=line><span class=ln>3</span><span class=cl>gcc -std<span class=o>=</span>c99 -Wall -g -o foo y.tab.c lex.yy.c
</span></span></code></pre></div><p>这样就生成了<code>foo</code>这个可执行文件
运行 foo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>liubang@venux:~/workspace/c/my_lang/lex$ make run
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=m>1</span> + <span class=m>3</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>&gt;&gt;4.000000
</span></span><span class=line><span class=ln>4</span><span class=cl>1/2
</span></span><span class=line><span class=ln>5</span><span class=cl>&gt;&gt;0.500000
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=m>4</span> * <span class=m>5</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>&gt;&gt;20.000000
</span></span></code></pre></div><p>当然我个人在开发 c 程序的时候偏向于使用 make 工具来编译代码，这样会很方便。下面是我的 Makefile 文件:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-makefile data-lang=makefile><span class=line><span class=ln> 1</span><span class=cl><span class=nv>CFLAGS</span> <span class=o>=</span> -O2 -g -Wall -std<span class=o>=</span>c99
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=nv>EXEC</span> <span class=o>=</span> foo
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=nv>OBJS</span> <span class=o>=</span>	y.tab.o <span class=se>\
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=se></span>	lex.yy.o
</span></span><span class=line><span class=ln> 5</span><span class=cl>
</span></span><span class=line><span class=ln> 6</span><span class=cl>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=nf>%.c</span><span class=o>:</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>	yacc -dv foo.y
</span></span><span class=line><span class=ln> 9</span><span class=cl>	lex foo.l
</span></span><span class=line><span class=ln>10</span><span class=cl>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=nf>%.o</span><span class=o>:</span> %.<span class=n>c</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>	 <span class=k>$(</span>CC<span class=k>)</span> <span class=k>$(</span>CFLAGS<span class=k>)</span> -o <span class=nv>$@</span> -c $&lt;
</span></span><span class=line><span class=ln>13</span><span class=cl>
</span></span><span class=line><span class=ln>14</span><span class=cl><span class=nf>$(EXEC)</span><span class=o>:</span> <span class=k>$(</span><span class=nv>OBJS</span><span class=k>)</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>	<span class=k>$(</span>CC<span class=k>)</span> <span class=k>$(</span>OBJS<span class=k>)</span> -o <span class=nv>$@</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=nf>all</span><span class=o>:</span> <span class=k>$(</span><span class=nv>EXEC</span><span class=k>)</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=nf>run</span><span class=o>:</span> <span class=k>$(</span><span class=nv>EXEC</span><span class=k>)</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>	@./<span class=k>$(</span>EXEC<span class=k>)</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=nf>clean</span><span class=o>:</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>	<span class=k>$(</span>RM<span class=k>)</span> <span class=k>$(</span>OBJS<span class=k>)</span> <span class=k>$(</span>EXEC<span class=k>)</span>
</span></span></code></pre></div><p>只需要执行<code>make run</code>命令即可运行！</p><h1 id=附加>附加<a class="anchor ms-1" href=#附加><i class="fas fa-link"></i></a></h1><p>可能有人会疑惑，这玩意学着有什么用，那么有兴趣的你可以下载一份 PHP 的源代码，在 Zend(Zend 引擎核心文件)目录中你不难找到<code>zend_language_scanner.l</code>,<code>zend_ini_scanner.l</code>,<code>zend_ini_parser.y</code>,<code>zend_language_parser.y</code>这几个文件，打开其内容，是不是不再那么恐惧和陌生了呢。</p><h1 id=summary>Summary<a class="anchor ms-1" href=#summary><i class="fas fa-link"></i></a></h1><p>本文只是初步介绍 yacc/lex 工具生成词法解析器和语法解析器的最基本用法，没有太多的阐述词法解析的原理和过程，所以更偏实践，再由于本人毕业一年多实在很久没写文章了，常常会提笔不知从何说起，所以写起来很慢，加之白天要工作，时间较紧，所以今天就到这里了，至于理论的阐述，需要时间来慢慢酝酿 😂！</p></div></div><div class=card-footer><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-circle-down" data-fa-transform=rotate-90></i>
<a href=/zh-cn/posts/php/2017-03-09-php%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E4%B9%8Bcall-user-func%E5%8E%9F%E7%90%86%E5%92%8C%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/>Php扩展开发之call_user_func原理和回调函数的实现</a></div><div class="post-nav post-next"><a href=/zh-cn/posts/sp/2017-03-17-%E5%BD%BB%E5%BA%95%E6%8E%8C%E6%8F%A1malloc/>彻底掌握malloc</a>
<i class="fas fa-fw fa-chevron-circle-down" data-fa-transform=rotate-270></i></div></div></div></article><div class="post-copyright mb-3 row card component" id=post-copyright><div class=card-header><h2 class=card-title>版权</h2></div><div class=card-body><a class="d-flex align-items-center flex-column" target=_blank rel="license noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh><span><i class="fab fa-fw fa-2x fa-creative-commons"></i><i class="fab fa-fw fa-2x fa-creative-commons-by"></i><i class="fab fa-fw fa-2x fa-creative-commons-nc"></i><i class="fab fa-fw fa-2x fa-creative-commons-nd"></i></span>
CC BY-NC-ND 4.0</a></div></div><section class="related-posts row card component"><div class=card-header><h2 class=card-title>相关文章</h2></div><div class=card-body><ul class=post-list><li><a href=/zh-cn/posts/php/2017-03-09-php%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E4%B9%8Bcall-user-func%E5%8E%9F%E7%90%86%E5%92%8C%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E7%8E%B0/>Php扩展开发之call_user_func原理和回调函数的实现</a>
<span class="float-end post-date">2017-03-09</span></li></ul></div></section><div class="card component row post-comments" id=post-comments><div class=card-header><h2 class=card-title>评论</h2></div><div class=card-body><script src=https://utteranc.es/client.js repo=liubang/blog issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></div></div></div></div><aside class="col-lg-4 sidebar d-flex"><div class="container d-flex flex-column"><div class="card row text-center profile component"><div class=card-body><div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt=liubang src=/images/profile.webp loading=lazy data-viewer-invisible width=1000 height=1000></div><div class="col-12 profile-meta"><div class=profile-name>liubang</div><div class=profile-bio>Whether you are an antelope or a lion, you ought to dash forward without hesitation when the sun rise</div><div class=profile-company><i class="fas fa-fw fa-building"></i>Baidu</div><div class=profile-location><i class="fas fa-fw fa-map-marker-alt"></i>Beijing</div><nav class="social-links nav justify-content-center"><a class="nav-link social-link" href=mailto:it.liubang@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope"></i>
</a><a class="nav-link social-link" target=_blank href=https://github.com/liubang title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i>
</a><a class="nav-link social-link" target=_blank href=https://weibo.com/2113750192 title=Weibo rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-weibo"></i>
</a><a class="nav-link social-link" target=_blank href=/zh-cn/index.xml title=RSS rel="noopener noreferrer"><i class="fas fa-fw fa-2x fa-rss"></i></a></nav></div></div></div><section class="recent-posts row card component"><div class=card-header><h2 class=card-title>最近文章</h2></div><div class=card-body><ul class=post-list><li><a href=/zh-cn/posts/cpp/2022-03-18-c++17-constexpr_if/>C++17:constexpr If</a></li><li><a href=/zh-cn/posts/cpp/2022-03-15-c++20-designated_initializers/>C++20:Designated Initializers</a></li><li><a href=/zh-cn/posts/cpp/2022-02-22-c++%E5%85%83%E7%BC%96%E7%A8%8B%E4%B9%8B%E9%81%8D%E5%8E%86tuple/>C++元编程之遍历tuple</a></li><li><a href=/zh-cn/posts/cpp/2022-02-14-c++17%E4%B9%8Bstring_view/>C++17:string_view</a></li><li><a href=/zh-cn/posts/storage/2021-01-12-leveldb%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8Bcompaction/>LevelDB 源码阅读之 Compaction</a></li></ul></div></section><section class="tags-taxonomies row card component"><div class=card-header><h2 class=card-title><a href=/zh-cn/tags>标签</a></h2></div><div class=card-body><div class=py-2><a href=/zh-cn/tags/c/ class="badge rounded post-taxonomy" title=c>c<span class="badge badge-sm text-white bg-accent ms-1">14</span></a><a href=/zh-cn/tags/c++/ class="badge rounded post-taxonomy" title=c++>
c++<span class="badge badge-sm text-white bg-accent ms-1">12</span></a><a href=/zh-cn/tags/php/ class="badge rounded post-taxonomy" title=php>
php<span class="badge badge-sm text-white bg-accent ms-1">8</span></a><a href=/zh-cn/tags/sp/ class="badge rounded post-taxonomy" title=sp>
sp<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href=/zh-cn/tags/java/ class="badge rounded post-taxonomy" title=Java>
Java<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href=/zh-cn/tags/jni/ class="badge rounded post-taxonomy" title=JNI>
JNI<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href=/zh-cn/tags/c++17/ class="badge rounded post-taxonomy" title=c++17>
c++17<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href=/zh-cn/tags/compiler/ class="badge rounded post-taxonomy" title=compiler>
compiler<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href=/zh-cn/tags/algorithm/ class="badge rounded post-taxonomy" title=algorithm>
algorithm<span class="badge badge-sm text-white bg-accent ms-1">1</span></a><a href=/zh-cn/tags/c++20/ class="badge rounded post-taxonomy" title=c++20>
c++20<span class="badge badge-sm text-white bg-accent ms-1">1</span></a><a href=/zh-cn/tags class="badge rounded post-taxonomy" title=ALL>
ALL
<span class="badge badge-sm text-white bg-accent ms-1">16</span></a></div></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><nav class="social-links nav justify-content-center mb-2"><a class="nav-link social-link" href=mailto:it.liubang@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope"></i>
</a><a class="nav-link social-link" target=_blank href=https://github.com/liubang title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i>
</a><a class="nav-link social-link" target=_blank href=https://weibo.com/2113750192 title=Weibo rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-weibo"></i>
</a><a class="nav-link social-link" target=_blank href=/zh-cn/index.xml title=RSS rel="noopener noreferrer"><i class="fas fa-fw fa-2x fa-rss"></i></a></nav><div class="copyright mb-2">Copyright © 2016-2022 LiuBang. All Rights Reserved.</div><div class="powered-by mb-2">Powered by <a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a> and the <a href=https://github.com/razonyang/hugo-theme-bootstrap target=_blank rel="noopener noreferrer">Bootstrap</a> theme.</div></footer><script src=/assets/main/bundle.min.3a1cad2d33d34b8ae89c31e7c9a4c8670eeb9364a846781b25956d5850ecba43.js integrity="sha256-OhytLTPTS4ronDHnyaTIZw7rk2SoRngbJZVtWFDsukM=" crossorigin=anonymous defer></script><script src=/assets/icons/bundle.min.03b7941a392c422ce1f92ac21024a6a320121d4ae3b2768fb4eb63480b4cf3e2.js integrity="sha256-A7eUGjksQizh+SrCECSmoyASHUrjsnaPtOtjSAtM8+I=" crossorigin=anonymous defer></script>
<script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.min.js").then(function(e){console.log("Successfully registered service worker",e)}).catch(function(e){console.warn("Error whilst registering service worker",e)})})</script><script src=/assets/viewer/bundle.min.3ce688736c8224a9cd6b3104011fc2a816428f07c0fa226359736f33f0c593de.js integrity="sha256-POaIc2yCJKnNazEEAR/CqBZCjwfA+iJjWXNvM/DFk94=" crossorigin=anonymous defer></script><script defer src=/assets/katex/bundle.min.c324e974e8755cbc7c0b3a8afcb459de67eed757a08db94579e54013b67f5762.js integrity="sha256-wyTpdOh1XLx8CzqK/LRZ3mfu11egjblFeeVAE7Z/V2I=" crossorigin=anonymous></script>
<script defer src=/assets/mermaid/bundle.min.e0678d67a61d9ab297dc3f1de9ca8e43614ce49e9e0d310b80787e532fca37a1.js integrity="sha256-4GeNZ6YdmrKX3D8d6cqOQ2FM5J6eDTELgHh+Uy/KN6E=" crossorigin=anonymous></script>
<script async src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e89c5f05bb0c6ec"></script></body></html>